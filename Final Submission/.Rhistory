modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	population.female,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`10-14 years`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`30-34 years`,	`35-39 years`,	`40-44 years`,	`45-49 years`,	`50-54 years`,	`55-59 years`,	`60-64 years`,	`65-69 years`,	`70-74 years`,	`75-79 years`,	`80-84 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`10-14 years`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`30-34 years`,	`35-39 years`,	`40-44 years`,	`45-49 years`,	`50-54 years`,	`55-59 years`,	`60-64 years`,	`65-69 years`,	`70-74 years`,	`75-79 years`,	`80-84 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`30-34 years`,	`35-39 years`,	`40-44 years`,	`45-49 years`,	`50-54 years`,	`55-59 years`,	`65-69 years`,	`70-74 years`,	`75-79 years`,	`80-84 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`30-34 years`,	`35-39 years`,	`40-44 years`,	`45-49 years`,	`55-59 years`,	`65-69 years`,	`70-74 years`,	`75-79 years`,	`80-84 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`30-34 years`,	`35-39 years`,	`40-44 years`,	`55-59 years`,	`65-69 years`,	`70-74 years`,	`75-79 years`,	`80-84 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`30-34 years`,	`35-39 years`,	`40-44 years`,	`55-59 years`,	`65-69 years`,	`75-79 years`,	`80-84 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`30-34 years`,	`35-39 years`,	`40-44 years`,	`55-59 years`,	`65-69 years`,	`80-84 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`, 	`35-39 years`,	`40-44 years`,	`55-59 years`,	`65-69 years`,	`80-84 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`40-44 years`,	`55-59 years`,	`65-69 years`,	`80-84 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`40-44 years`,	`55-59 years`,	`65-69 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`55-59 years`,	`65-69 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`25-29 years`, 	`65-69 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`,	`65-69 years`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
alias(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`15-19 years`,	`20-24 years`, 	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`< 1 year`,	`20-24 years`, 	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`20-24 years`, 	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`85+ years`)
modelTrain <- modelDataFinal %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataFinal %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
alias(lm1)
pred <- predict(lm1, newdata = modelTest)
pred
min(pred)
maz(pred)
max(pred)
hist(pred)
randomForest::randomForest(modelDataFinal)
View(modelData)
names(modelDa)
names(modelData)
modelDataNew <- modelData %>% mutate(lforce_perc = lforce/population)
View(modelDataNew)
modelDataNew <- modelData %>% mutate(lforce_perc = lforce/population, emp_perc = emp/population, unemp_perc = unemp/population,
unrate_perc = unrate/population, imig_perc = imig/emp_perc, dmig_perc = dmig/population,
nmig_perc = nmig/population, popFemale_perc = population.female/population, popMale_perc = population.male/population,
AmInd_perc = `American Indian or Alaska Native`/population, Asian_perc = `Asian or Pacific Islander`/population,
AfAm_perc = `Black or African American`/population, White_perc = White/population, Age_0_14_perc = (`< 1 year` + `10-14 years`)/population,
Age_15_24_perc = (`15-19 years` + `20-24 years`)/population, Age_25_34_perc = (`25-29 years` + `30-34 years`)/population,
Age_35_44_perc = (`35-39 years` + `40-44 years`)/population, Age_45_54_perc = (`45-49 years` + `50-54 years`)/population,
Age_55_64_perc = (`55-59 years` + `60-64 years`)/population, Age_65_74_perc = (`65-69 years` + `70-74 years`)/population,
Age_74_84_perc = (`75-79 years` + `80-84 years`)/population, Age_85_perc = (`85+ years`)/population) %>%
dplyr::select(year, pd, lforce_perc, emp_perc, unemp_perc, unrate_perc, imig_perc, dmig_perc, nmig_perc, population.female,
popMale_perc, AmInd_perc, Asian_perc, AfAm_perc, White_perc, Age_0_14_perc, Age_15_24_perc, Age_25_34_perc, Age_35_44_perc,
Age_45_54_perc, Age_55_64_perc, Age_65_74_perc, Age_74_84_perc, Age_85_perc)
View(modelDataNew)
modelDataNew <- modelData %>% mutate(lforce_perc = lforce/population, emp_perc = emp/population, unemp_perc = unemp/population,
unrate_perc = unrate/population, imig_perc = imig/emp_perc, dmig_perc = dmig/population,
nmig_perc = nmig/population, popFemale_perc = population.female/population, popMale_perc = population.male/population,
AmInd_perc = `American Indian or Alaska Native`/population, Asian_perc = `Asian or Pacific Islander`/population,
AfAm_perc = `Black or African American`/population, White_perc = White/population, Age_0_14_perc = (`< 1 year` + `10-14 years`)/population,
Age_15_24_perc = (`15-19 years` + `20-24 years`)/population, Age_25_34_perc = (`25-29 years` + `30-34 years`)/population,
Age_35_44_perc = (`35-39 years` + `40-44 years`)/population, Age_45_54_perc = (`45-49 years` + `50-54 years`)/population,
Age_55_64_perc = (`55-59 years` + `60-64 years`)/population, Age_65_74_perc = (`65-69 years` + `70-74 years`)/population,
Age_74_84_perc = (`75-79 years` + `80-84 years`)/population, Age_85_perc = (`85+ years`)/population) %>%
dplyr::select(year, pd, lforce_perc, emp_perc, unemp_perc, unrate_perc, imig_perc, dmig_perc, nmig_perc, popFemale_perc,
popMale_perc, AmInd_perc, Asian_perc, AfAm_perc, White_perc, Age_0_14_perc, Age_15_24_perc, Age_25_34_perc, Age_35_44_perc,
Age_45_54_perc, Age_55_64_perc, Age_65_74_perc, Age_74_84_perc, Age_85_perc)
View(modelDataNew)
#modelDataFinal <- mergedElectionData2012And2016 %>% dplyr::select(year,	pd,	emp,	unrate,	imig,	dmig, 	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	`85+ years`)
modelTrain <- modelDataNew %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataNew %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
alias(lm1)
hist(modelTrain$pd)
hist(modelTrain$lforce_perc)
vif(lm1)
alias(lm1)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc)
View(modelDataNew)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc)
modelTrain <- modelDataNew2 %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataNew2 %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
alias(lm1)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc)
modelTrain <- modelDataNew2 %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataNew2 %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc)
modelTrain <- modelDataNew2 %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataNew2 %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc, -nmig_perc)
modelTrain <- modelDataNew2 %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataNew2 %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc, -nmig_perc, -Age_15_24_perc)
modelTrain <- modelDataNew2 %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataNew2 %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
ggplot(data = modelDataNew2) +
geom_density(mapping = aes(x = emp_perc))
ggplot(data = modelDataNew2) +
geom_boxplot(mapping = aes(x = emp_perc))
quantile(modelDataNew2$emp_perc, 0.99)
fun( modelDataNew2 )
fun <- function(x){
quantiles <- quantile( x, c(.05, .95 ) )
x[ x < quantiles[1] ] <- quantiles[1]
x[ x > quantiles[2] ] <- quantiles[2]
x
}
fun( modelDataNew2 )
View(modelDataNew2)
ncol(modelDataNew2)
fun( modelDataNew2[, 3:18] )
fun( modelDataNew2[, 3] )
fun( modelDataNew2[, 4] )
fun( modelDataNew2[, 5] )
View(modelDataNew2)
View(modelData)
modelDataNew <- modelData %>% mutate(lforce_perc = lforce/population, emp_perc = emp/population, unemp_perc = unemp/population,
unrate_perc = unrate/population, imig_perc = imig/population, dmig_perc = dmig/population,
nmig_perc = nmig/population, popFemale_perc = population.female/population, popMale_perc = population.male/population,
AmInd_perc = `American Indian or Alaska Native`/population, Asian_perc = `Asian or Pacific Islander`/population,
AfAm_perc = `Black or African American`/population, White_perc = White/population, Age_0_14_perc = (`< 1 year` + `10-14 years`)/population,
Age_15_24_perc = (`15-19 years` + `20-24 years`)/population, Age_25_34_perc = (`25-29 years` + `30-34 years`)/population,
Age_35_44_perc = (`35-39 years` + `40-44 years`)/population, Age_45_54_perc = (`45-49 years` + `50-54 years`)/population,
Age_55_64_perc = (`55-59 years` + `60-64 years`)/population, Age_65_74_perc = (`65-69 years` + `70-74 years`)/population,
Age_74_84_perc = (`75-79 years` + `80-84 years`)/population, Age_85_perc = (`85+ years`)/population) %>%
dplyr::select(year, pd, lforce_perc, emp_perc, unemp_perc, unrate_perc, imig_perc, dmig_perc, nmig_perc, popFemale_perc,
popMale_perc, AmInd_perc, Asian_perc, AfAm_perc, White_perc, Age_0_14_perc, Age_15_24_perc, Age_25_34_perc, Age_35_44_perc,
Age_45_54_perc, Age_55_64_perc, Age_65_74_perc, Age_74_84_perc, Age_85_perc)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc, -nmig_perc, -Age_15_24_perc)
fun <- function(x){
quantiles <- quantile( x, c(.01, .99 ) )
x[ x < quantiles[1] ] <- quantiles[1]
x[ x > quantiles[2] ] <- quantiles[2]
x
}
fun( modelDataNew2[, 5] )
modelDataNew2$emp_perc <- fun( modelDataNew2$emp_perc )
modelDataNew2$unrate_perc <- fun( modelDataNew2$unrate_perc )
modelDataNew2$imig_perc <- fun( modelDataNew2$imig_perc )
modelDataNew2$dmig_perc <- fun( modelDataNew2$imig_perc )
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc, -nmig_perc, -Age_15_24_perc)
for (name in names(modelDataNew2)){
if(!(name %in% c('year', 'pd'))){
modelDataNew2[, name] <- fun( modelDataNew2[, name] )
}
}
View(modelDataNew2)
ggplot(data = modelDataNew2) +
geom_density(mapping = aes(x = emp_perc))
ggplot(data = modelDataNew2) +
geom_boxplot(mapping = aes(x = emp_perc))
modelTrain <- modelDataNew2 %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataNew2 %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc, -nmig_perc, -Age_15_24_perc)
fun <- function(x){
quantiles <- quantile( x, c(.05, .95 ) )
x[ x < quantiles[1] ] <- quantiles[1]
x[ x > quantiles[2] ] <- quantiles[2]
x
}
for (name in names(modelDataNew2)){
if(!(name %in% c('year', 'pd'))){
modelDataNew2[, name] <- fun( modelDataNew2[, name] )
}
}
ggplot(data = modelDataNew2) +
geom_density(mapping = aes(x = emp_perc))
ggplot(data = modelDataNew2) +
geom_boxplot(mapping = aes(x = emp_perc))
modelTrain <- modelDataNew2 %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataNew2 %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
fun <- function(x){
quantiles <- quantile( x, c(.01, .99 ) )
x[ x < quantiles[1] ] <- quantiles[1]
x[ x > quantiles[2] ] <- quantiles[2]
x
}
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc, -nmig_perc, -Age_15_24_perc)
fun <- function(x){
quantiles <- quantile( x, c(.01, .99 ) )
x[ x < quantiles[1] ] <- quantiles[1]
x[ x > quantiles[2] ] <- quantiles[2]
x
}
for (name in names(modelDataNew2)){
if(!(name %in% c('year', 'pd'))){
modelDataNew2[, name] <- fun( modelDataNew2[, name] )
}
}
ggplot(data = modelDataNew2) +
geom_density(mapping = aes(x = emp_perc))
ggplot(data = modelDataNew2) +
geom_boxplot(mapping = aes(x = emp_perc))
modelTrain <- modelDataNew2 %>% filter(year == 2012) %>% dplyr::select(-year)
modelTest <- modelDataNew2 %>% filter(year == 2016) %>% dplyr::select(-year, -pd)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
getwd()
crime2011 <- read_excel(paste0("C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/Final Project/Presidential_Election_2016_Classification/Data/Additional Data Crime.xlsx"), sheet = "CRIME 2011")
View(crime2011)
View(crime2011)
crime2015 <- read_excel(paste0("C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/Final Project/Presidential_Election_2016_Classification/Data/Additional Data Crime.xlsx"), sheet = "CRIME 2015")
crime2011$year <- 2011
crime2015$year <- 2015
crime <- rbind(crime2011, crime2015)
View(crime)
View(modelDataNew2)
?inner_join
View(modelDataNew2)
View(mergedElectionData2012And2016)
View(ElectionData2016)
View(ElectionData)
###########################################################################################
#                          Creating 2012 and 2016 Data Set                                #
###########################################################################################
ElectionData2012 <- ElectionData %>%
dplyr::select(c_fips, v2012, vd2012, vg2012, pd2012, pg2012, diff2012, ppd2012, lforce11, emp11, unemp11, unrate11,
imig11, dmig11, nmig11, population.2011, population.female.2011, population.male.2011,
`American Indian or Alaska Native.2011`, `Asian or Pacific Islander.2011`, `Black or African American.2011`, White.2011,
`< 1 year.2011`, `10-14 years.2011`, `15-19 years.2011`, `20-24 years.2011`, `25-29 years.2011`, `30-34 years.2011`,
`35-39 years.2011`, `40-44 years.2011`, `45-49 years.2011`, `50-54 years.2011`, `55-59 years.2011`, `60-64 years.2011`,
`65-69 years.2011`, `70-74 years.2011`, `75-79 years.2011`, `80-84 years.2011`, `85+ years.2011`) %>%
add_column(year = "2012", .before = "v2012") %>%
rename_with(~ sub("(.2011$|2012$|11$)", "", .x), .cols = everything())
ElectionData2016 <- ElectionData %>%
dplyr::select(c_fips, v2016, vd2016, vg2016, pd2016, pg2016, diff2016, ppd2016, lforce15, emp15, unemp15, unrate15,
imig15, dmig15, nmig15, population.2015, population.female.2015, population.male.2015,
`American Indian or Alaska Native.2015`, `Asian or Pacific Islander.2015`, `Black or African American.2015`, White.2015,
`< 1 year.2015`, `10-14 years.2015`, `15-19 years.2015`, `20-24 years.2015`, `25-29 years.2015`, `30-34 years.2015`,
`35-39 years.2015`, `40-44 years.2015`, `45-49 years.2015`, `50-54 years.2015`, `55-59 years.2015`, `60-64 years.2015`,
`65-69 years.2015`, `70-74 years.2015`, `75-79 years.2015`, `80-84 years.2015`, `85+ years.2015`) %>%
add_column(year = "2016", .before = "v2016") %>%
rename_with(~ sub("(.2015$|2016$|15$)", "", .x), .cols = everything())
mergedElectionData2012And2016 <- rbind(ElectionData2012, ElectionData2016)
View(mergedElectionData2012And2016)
modelData<- mergedElectionData2012And2016 %>% dplyr::select(year, c_fips,	pd,	lforce,	emp,	unemp,	unrate,	imig,	dmig,	nmig,	population,	population.female,	population.male,	`American Indian or Alaska Native`,	`Asian or Pacific Islander`,	`Black or African American`,	White,	`< 1 year`,	`10-14 years`,	`15-19 years`,	`20-24 years`,	`25-29 years`,	`30-34 years`,	`35-39 years`,	`40-44 years`,	`45-49 years`,	`50-54 years`,	`55-59 years`,	`60-64 years`,	`65-69 years`,	`70-74 years`,	`75-79 years`,	`80-84 years`,	`85+ years`)
modelDataNew <- modelData %>% mutate(lforce_perc = lforce/population, emp_perc = emp/population, unemp_perc = unemp/population,
unrate_perc = unrate/population, imig_perc = imig/population, dmig_perc = dmig/population,
nmig_perc = nmig/population, popFemale_perc = population.female/population, popMale_perc = population.male/population,
AmInd_perc = `American Indian or Alaska Native`/population, Asian_perc = `Asian or Pacific Islander`/population,
AfAm_perc = `Black or African American`/population, White_perc = White/population, Age_0_14_perc = (`< 1 year` + `10-14 years`)/population,
Age_15_24_perc = (`15-19 years` + `20-24 years`)/population, Age_25_34_perc = (`25-29 years` + `30-34 years`)/population,
Age_35_44_perc = (`35-39 years` + `40-44 years`)/population, Age_45_54_perc = (`45-49 years` + `50-54 years`)/population,
Age_55_64_perc = (`55-59 years` + `60-64 years`)/population, Age_65_74_perc = (`65-69 years` + `70-74 years`)/population,
Age_74_84_perc = (`75-79 years` + `80-84 years`)/population, Age_85_perc = (`85+ years`)/population) %>%
dplyr::select(year, pd, lforce_perc, emp_perc, unemp_perc, unrate_perc, imig_perc, dmig_perc, nmig_perc, popFemale_perc,
popMale_perc, AmInd_perc, Asian_perc, AfAm_perc, White_perc, Age_0_14_perc, Age_15_24_perc, Age_25_34_perc, Age_35_44_perc,
Age_45_54_perc, Age_55_64_perc, Age_65_74_perc, Age_74_84_perc, Age_85_perc)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc, -nmig_perc, -Age_15_24_perc)
fun <- function(x){
quantiles <- quantile( x, c(.01, .99 ) )
x[ x < quantiles[1] ] <- quantiles[1]
x[ x > quantiles[2] ] <- quantiles[2]
x
}
for (name in names(modelDataNew2)){
if(!(name %in% c('year', 'pd'))){
modelDataNew2[, name] <- fun( modelDataNew2[, name] )
}
}
View(crime)
View(modelDataNew2)
View(crime)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
View(modelDataNew2)
View(modelDataNew)
modelDataNew <- modelData %>% mutate(lforce_perc = lforce/population, emp_perc = emp/population, unemp_perc = unemp/population,
unrate_perc = unrate/population, imig_perc = imig/population, dmig_perc = dmig/population,
nmig_perc = nmig/population, popFemale_perc = population.female/population, popMale_perc = population.male/population,
AmInd_perc = `American Indian or Alaska Native`/population, Asian_perc = `Asian or Pacific Islander`/population,
AfAm_perc = `Black or African American`/population, White_perc = White/population, Age_0_14_perc = (`< 1 year` + `10-14 years`)/population,
Age_15_24_perc = (`15-19 years` + `20-24 years`)/population, Age_25_34_perc = (`25-29 years` + `30-34 years`)/population,
Age_35_44_perc = (`35-39 years` + `40-44 years`)/population, Age_45_54_perc = (`45-49 years` + `50-54 years`)/population,
Age_55_64_perc = (`55-59 years` + `60-64 years`)/population, Age_65_74_perc = (`65-69 years` + `70-74 years`)/population,
Age_74_84_perc = (`75-79 years` + `80-84 years`)/population, Age_85_perc = (`85+ years`)/population) %>%
dplyr::select(year, c_fips, pd, lforce_perc, emp_perc, unemp_perc, unrate_perc, imig_perc, dmig_perc, nmig_perc, popFemale_perc,
popMale_perc, AmInd_perc, Asian_perc, AfAm_perc, White_perc, Age_0_14_perc, Age_15_24_perc, Age_25_34_perc, Age_35_44_perc,
Age_45_54_perc, Age_55_64_perc, Age_65_74_perc, Age_74_84_perc, Age_85_perc)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc, -nmig_perc, -Age_15_24_perc)
fun <- function(x){
quantiles <- quantile( x, c(.01, .99 ) )
x[ x < quantiles[1] ] <- quantiles[1]
x[ x > quantiles[2] ] <- quantiles[2]
x
}
if(!(name %in% c('year', 'pd', 'c_fips'))){
modelDataNew2[, name] <- fun( modelDataNew2[, name] )
}
for (name in names(modelDataNew2)){
if(!(name %in% c('year', 'pd', 'c_fips'))){
modelDataNew2[, name] <- fun( modelDataNew2[, name] )
}
}
crime2011 <- read_excel(paste0("C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/Final Project/Presidential_Election_2016_Classification/Data/Additional Data Crime.xlsx"), sheet = "CRIME 2011")
crime2011$year <- 2011
crime2015 <- read_excel(paste0("C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/Final Project/Presidential_Election_2016_Classification/Data/Additional Data Crime.xlsx"), sheet = "CRIME 2015")
crime2015$year <- 2015
crime <- rbind(crime2011, crime2015)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
View(modelDataNew2)
View(modelDataNew2)
View(crime)
modelDataNew2$c_fips <- as.factor(modelDataNew2$c_fips)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
modelDataNew2$c_fips <- as.double(modelDataNew2$c_fips)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
crime$FIPS_COUNTY <- as.factor(crime$FIPS_COUNTY)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
View(modelDataNew2)
modelDataNew2 <- modelDataNew %>% dplyr::select(-unemp_perc, -popMale_perc, -White_perc, -lforce_perc, -nmig_perc, -Age_15_24_perc)
fun <- function(x){
quantiles <- quantile( x, c(.01, .99 ) )
x[ x < quantiles[1] ] <- quantiles[1]
x[ x > quantiles[2] ] <- quantiles[2]
x
}
for (name in names(modelDataNew2)){
if(!(name %in% c('year', 'pd', 'c_fips'))){
modelDataNew2[, name] <- fun( modelDataNew2[, name] )
}
}
modelDataNew2$c_fips <- as.factor(modelDataNew2$c_fips)
crime$FIPS_COUNTY <- as.factor(crime$FIPS_COUNTY)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
View(modelDataNew2)
modelDataNew2$year <- as.factor(modelDataNew2$year)
crime$year <- as.factor(crime$year)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
View(modelDataNew3)
View(modelDataNew2)
crime2011$year <- 2012
crime2015 <- read_excel(paste0("C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/Final Project/Presidential_Election_2016_Classification/Data/Additional Data Crime.xlsx"), sheet = "CRIME 2015")
crime2015$year <- 2016
modelDataNew2$year <- as.factor(modelDataNew2$year)
crime$year <- as.factor(crime$year)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
View(modelDataNew3)
View(modelDataNew2)
View(crime)
crime <- rbind(crime2011, crime2015)
modelDataNew2$year <- as.factor(modelDataNew2$year)
crime$year <- as.factor(crime$year)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
View(modelDataNew3)
crime2011 <- read_excel(paste0("C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/Final Project/Presidential_Election_2016_Classification/Data/Additional Data Crime.xlsx"), sheet = "CRIME 2011")
crime2011$year <- 2012
crime2015 <- read_excel(paste0("C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/Final Project/Presidential_Election_2016_Classification/Data/Additional Data Crime.xlsx"), sheet = "CRIME 2015")
crime2015$year <- 2016
crime <- rbind(crime2011, crime2015)
modelDataNew2$c_fips <- as.factor(modelDataNew2$c_fips)
crime$FIPS_COUNTY <- as.factor(crime$FIPS_COUNTY)
modelDataNew2$year <- as.factor(modelDataNew2$year)
crime$year <- as.factor(crime$year)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
View(modelDataNew3)
View(modelDataNew2)
View(modelDataNew3)
modelTrain <- modelDataNew2 %>% filter(year == 2012) %>% dplyr::select(-year, -c_fips)
modelTest <- modelDataNew3 %>% filter(year == 2016) %>% dplyr::select(-year, -pd, -c_fips)
modelTrain <- modelDataNew3 %>% filter(year == 2012) %>% dplyr::select(-year, -c_fips)
modelTest <- modelDataNew3 %>% filter(year == 2016) %>% dplyr::select(-year, -pd, -c_fips)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
?sd
fun2 <- function(x){
x <- (x - mean(x))/sd(x)
x
}
View(crime)
fun2 <- function(x){
x <- (x - mean(x))/sd(x)
x
}
for (name in names(crime)){
if(!(name %in% c('year', 'FIPS_COUNTY'))){
crime[, name] <- fun2( crime[, name] )
}
}
fun2(crime$CPOPARST)
name
fun2(crime[, name])
name
crime[, name]
crime[, name][]
crime[, name][[]]
crime[, name][[1]]
for (name in names(crime)){
if(!(name %in% c('year', 'FIPS_COUNTY'))){
crime[, name] <- fun2( crime[, name][[1]] )
}
}
View(crime)
modelDataNew2$c_fips <- as.factor(modelDataNew2$c_fips)
crime$FIPS_COUNTY <- as.factor(crime$FIPS_COUNTY)
modelDataNew2$year <- as.factor(modelDataNew2$year)
crime$year <- as.factor(crime$year)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
ggplot(data = modelDataNew2) +
geom_density(mapping = aes(x = emp_perc))
modelTrain <- modelDataNew3 %>% filter(year == 2012) %>% dplyr::select(-year, -c_fips)
modelTest <- modelDataNew3 %>% filter(year == 2016) %>% dplyr::select(-year, -pd, -c_fips)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
View(modelTrain)
modelTrain <- modelDataNew3 %>% dplyr::select(-year, -c_fips)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
modelTrain <- modelDataNew3 %>% filter(year == 2012) %>% dplyr::select(-year, -c_fips)
modelTest <- modelDataNew3 %>% filter(year == 2016) %>% dplyr::select(-year, -pd, -c_fips)
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
