ggplot(data = modelDataNew2) +
geom_density(mapping = aes(x = log(emp_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = emp_perc))
names(modelDataNew3)
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = unrate_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(unrate_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(imig_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(dmig_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = dmig_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(dmig_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = popFemale_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(popFemale_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = AmInd_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(AmInd_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = Asian_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(Asian_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = AfAm_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(AfAm_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = Age_0_14_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(Age_0_14_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = Age_25_34_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(Age_25_34_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = Age_25_34_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = Age_35_44_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = Age_45_54_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = Age_55_64_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = Age_85_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = CPOPARST))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(CPOPARST)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = CPOPCRIM))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(CPOPCRIM)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = AG_ARRST))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(AG_ARRST)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = AG_OFF))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(AG_OFF)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = COVIND))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(COVIND)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = COVIND*COVIND))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = exp(COVIND)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = COVIND))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = VIOL))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(VIOL)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = PROPERTY))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(PROPERTY)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = MURDER))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(MURDER)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = RAPE))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(RAPE)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = ROBBERY))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(ROBBERY)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = AGASSLT))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(AGASSLT)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = BURGLRY))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(BURGLRY)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = BURGLRY))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(BURGLRY)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = LARCENY))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(BURGLRY)))
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + log(imig_perc) + log(dmig_perc) + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(CPOPARST) + log(CPOPCRIM) +
log(AG_ARRST) + log(AG_OFF) + log(COVIND) + log(VIOL) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT) + log(ARSON), data = modelTrain)
summary(lm1)
modelTrain <- modelDataNew3 %>% filter(year == 2012) %>% dplyr::select(-year, -c_fips)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + log(imig_perc) + log(dmig_perc) + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(CPOPARST) + log(CPOPCRIM) +
log(AG_ARRST) + log(AG_OFF) + log(COVIND) + log(VIOL) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT) + log(ARSON), data = modelTrain)
summary(lm1)
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(imig_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(imig_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = imig_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = dmig_perc))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(dmig_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = popFemale_perc))
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(CPOPARST) + log(CPOPCRIM) +
log(AG_ARRST) + log(AG_OFF) + log(COVIND) + log(VIOL) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT) + log(ARSON), data = modelTrain)
summary(lm1)
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = CPOPARST))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(CPOPARST)))
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + CPOPARST + log(CPOPCRIM) +
log(AG_ARRST) + log(AG_OFF) + log(COVIND) + log(VIOL) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT) + log(ARSON), data = modelTrain)
summary(lm1)
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = CPOPCRIM))
ggplot(data = modelDataNew2) +
geom_boxplot(mapping = aes(x = CPOPCRIM))
crime <- rbind(crime2011, crime2015)
modelDataNew2$c_fips <- as.factor(modelDataNew2$c_fips)
crime$FIPS_COUNTY <- as.factor(crime$FIPS_COUNTY)
modelDataNew2$year <- as.factor(modelDataNew2$year)
crime$year <- as.factor(crime$year)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = CPOPCRIM))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(CPOPARST)))
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(CPOPARST) + log(CPOPCRIM) +
log(AG_ARRST) + log(AG_OFF) + log(COVIND) + log(VIOL) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT) + log(ARSON), data = modelTrain)
summary(lm1)
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(unrate_perc)))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = ARSON))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(ARSON)))
min(ARSON)
min(modelTrain$ARSON)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(CPOPARST) + log(CPOPCRIM) +
log(AG_ARRST) + log(AG_OFF) + log(COVIND) + log(VIOL) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT) + ARSON, data = modelTrain)
min(modelTrain$MVTHEFT)
View(modelTrain)
modelTrain <- modelDataNew3 %>% filter(year == 2012) %>% dplyr::select(-year, -c_fips)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(CPOPARST) + log(CPOPCRIM) +
log(AG_ARRST) + log(AG_OFF) + log(COVIND) + log(VIOL) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT) + ARSON, data = modelTrain)
View(modelTrain)
colSums(is.na(modelTrain))
colSums(is.nan(modelTrain))
is.nan(modelDataNew3$ARSON)
write.csv(modelTrain, "train.csv")
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT) + ARSON, data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) , data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL) + log(PROPERTY) + log(MURDER) , data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL)  + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) +  log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
unique(log(VIOL))
unique(log(modelTrain$VIOL))
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) +  log(PROPERTY) + log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) +  log(MURDER) + log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) +  log(RAPE) + log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) +   log(ROBBERY) +
log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(AGASSLT) + log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) +  log(BURGLRY) + log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) +   log(LARCENY) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(MVTHEFT), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) , data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL), data = modelTrain)
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = VIOL))
ggplot(data = modelDataNew3) +
geom_density(mapping = aes(x = log(VIOL)))
min(modelTrain$VIOL)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL+1), data = modelTrain)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL+1)  + log(PROPERTY +1), data = modelTrain)
summary(lm1)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) , data = modelTrain)
summary(lm1)
lm0 <- lm(pd ~ ., data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ emp_perc + unrate_perc + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + CPOPARST + CPOPCRIM + AG_ARRST + AG_OFF + COVIND + VIOL + PROPERTY + MURDER + RAPE + ROBBERY + AGASSLT +
BURGLRY + LARCENY + MVTHEFT + ARSON, data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + unrate_perc + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + CPOPARST + CPOPCRIM + AG_ARRST + AG_OFF + COVIND + VIOL + PROPERTY + MURDER + RAPE + ROBBERY + AGASSLT +
BURGLRY + LARCENY + MVTHEFT + ARSON, data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + CPOPARST + CPOPCRIM + AG_ARRST + AG_OFF + COVIND + VIOL + PROPERTY + MURDER + RAPE + ROBBERY + AGASSLT +
BURGLRY + LARCENY + MVTHEFT + ARSON, data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + Asian_perc + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + CPOPARST + CPOPCRIM + AG_ARRST + AG_OFF + COVIND + VIOL + PROPERTY + MURDER + RAPE + ROBBERY + AGASSLT +
BURGLRY + LARCENY + MVTHEFT + ARSON, data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) + Asian_perc + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + CPOPARST + CPOPCRIM + AG_ARRST + AG_OFF + COVIND + VIOL + PROPERTY + MURDER + RAPE + ROBBERY + AGASSLT +
BURGLRY + LARCENY + MVTHEFT + ARSON, data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + CPOPARST + CPOPCRIM + AG_ARRST + AG_OFF + COVIND + VIOL + PROPERTY + MURDER + RAPE + ROBBERY + AGASSLT +
BURGLRY + LARCENY + MVTHEFT + ARSON, data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + CPOPARST + CPOPCRIM + AG_ARRST + AG_OFF + COVIND + VIOL + PROPERTY + MURDER + RAPE + ROBBERY + AGASSLT +
BURGLRY + LARCENY + MVTHEFT + ARSON, data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + VIOL + PROPERTY, data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + VIOL + log(PROPERTY + ), data = modelTrain)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + VIOL + log(PROPERTY + 1), data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
Age_85_perc + log(VIOL +1) + log(PROPERTY + 1), data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
log(Age_85_perc) + log(VIOL +1) + log(PROPERTY + 1), data = modelTrain)
summary(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + log(Age_74_84_perc) +
log(Age_85_perc) + log(VIOL +1) + log(PROPERTY + 1), data = modelTrain)
summary(lm0)
vif(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
log(Age_85_perc) + log(VIOL +1) , data = modelTrain)
summary(lm0)
vif(lm0)
lm1 <- lm(pd ~ log(emp_perc) +  imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL+1)  + log(PROPERTY +1), data = modelTrain)
summary(lm1)
lm1 <- lm(pd ~ log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL+1)  + log(PROPERTY +1), data = modelTrain)
summary(lm1)
lm1 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) +
log(Asian_perc) + log(AfAm_perc) +  log(Age_0_14_perc) + log(Age_25_34_perc) + log(Age_35_44_perc) + log(Age_45_54_perc) +
log(Age_55_64_perc) + log(Age_65_74_perc) + log(Age_74_84_perc) + log(Age_85_perc) + log(VIOL+1)  + log(PROPERTY +1), data = modelTrain)
summary(lm1)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
log(Age_85_perc) + log(VIOL +1) + log(PROPERTY + 1), data = modelTrain)
summary(lm0)
vif(lm0)
lm0 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + log(Asian_perc) + AfAm_perc +
Age_0_14_perc + Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc +
log(Age_85_perc) + log(VIOL +1), data = modelTrain)
summary(lm0)
vif(lm0)
crime2011 <- read_excel(paste0("C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/Final Project/Presidential_Election_2016_Classification/Data/Additional Data Crime.xlsx"), sheet = "CRIME 2011")
crime2011$year <- 2012
crime2015 <- read_excel(paste0("C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/Final Project/Presidential_Election_2016_Classification/Data/Additional Data Crime.xlsx"), sheet = "CRIME 2015")
crime2015$year <- 2016
crime <- rbind(crime2011, crime2015)
fun2 <- function(x){
x <- (x - mean(x))/sd(x)
x
}
for (name in names(crime)){
if(!(name %in% c('year', 'FIPS_COUNTY'))){
crime[, name] <- fun2( crime[, name][[1]] )
}
}
modelDataNew2$c_fips <- as.factor(modelDataNew2$c_fips)
crime$FIPS_COUNTY <- as.factor(crime$FIPS_COUNTY)
modelDataNew2$year <- as.factor(modelDataNew2$year)
crime$year <- as.factor(crime$year)
modelDataNew3 <- modelDataNew2 %>% inner_join(crime, by = c("c_fips" = "FIPS_COUNTY", "year" = "year"))
lm1 <- lm(pd ~ ., data = modelTrain)
summary(lm1)
vif(lm1)
lm1 <- lm(pd ~ emp_perc + unrate_perc + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc + Age_85_perc +
VIOL + PROPERTY + MURDER + RAPE + ROBBERY + AGASSLT + BURGLRY + LARCENY + MVTHEFT + ARSON, data = modelTrain)
summary(lm1)
vif(lm1)
options(scipen = 22)
lm1 <- lm(pd ~ emp_perc + unrate_perc + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc + Age_85_perc +
VIOL + PROPERTY + MURDER + RAPE + ROBBERY + AGASSLT + BURGLRY + LARCENY + MVTHEFT + ARSON, data = modelTrain)
summary(lm1)
vif(lm1)
lm1 <- lm(pd ~ emp_perc + unrate_perc + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc + Age_85_perc +
VIOL + PROPERTY, data = modelTrain)
summary(lm1)
vif(lm1)
lm1 <- lm(pd ~ emp_perc + unrate_perc + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc +  Age_85_perc +
VIOL + PROPERTY, data = modelTrain)
summary(lm1)
vif(lm1)
lm1 <- lm(pd ~ emp_perc + unrate_perc + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc +  Age_85_perc + VIOL, data = modelTrain)
summary(lm1)
vif(lm1)
lm2 <- lm(pd ~ log(emp_perc) + unrate_perc + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc +  Age_85_perc + VIOL, data = modelTrain)
summary(lm2)
lm2 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc +  Age_85_perc + VIOL, data = modelTrain)
summary(lm2)
lm2 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc +  Age_85_perc + VIOL, data = modelTrain)
summary(lm2)
lm2 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc +  Age_85_perc + VIOL, data = modelTrain)
summary(lm2)
vif(lm1)
lm2 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + log(AmInd_perc) + log(Asian_perc) + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc +  Age_85_perc + VIOL, data = modelTrain)
summary(lm2)
lm2 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + log(popFemale_perc) + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc +  Age_85_perc + VIOL, data = modelTrain)
summary(lm2)
lm2 <- lm(pd ~ log(emp_perc) + log(unrate_perc) + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_25_34_perc + Age_35_44_perc + Age_45_54_perc + Age_55_64_perc + Age_65_74_perc +  Age_85_perc + VIOL, data = modelTrain)
summary(lm2)
set.seed(454)
View(modelTrain)
train <- modelTrain
test <- modelTest
train_x <- model.matrix(pd2016 ~ ., train)[, -1]
train_x <- model.matrix(pd ~ ., train)[, -1]
test_x <- model.matrix(pd ~ ., test)[, -1]
View(modelTest)
modelTrainLasso <- modelDataNew3 %>% filter(year == 2012) %>% dplyr::select(-year, -c_fips)
modelTestLasso <- modelDataNew3 %>% filter(year == 2016) %>% dplyr::select(-year, -c_fips)
View(modelTest)
train <- modelTrainLasso
test <- modelTestLasso
train_x <- model.matrix(pd ~ ., train)[, -1]
test_x <- model.matrix(pd ~ ., test)[, -1]
test_y <- test$pd
################################################################
# Find best value of Lambda using Cross-Validation
################################################################
set.seed(454)
cv.lasso <- cv.glmnet(train_x, train_y)
train_y
test_y
train_x
cv.lasso <- cv.glmnet(train_x, train_y)
nrow(train_x)
nrow(test_x)
length(train_y)
length(test_y)
nrow(train)
train_y <- train$pd
test_y <- test$pd
################################################################
# Find best value of Lambda using Cross-Validation
################################################################
set.seed(454)
cv.lasso <- cv.glmnet(train_x, train_y)
plot(cv.lasso)
################################################################
# Optimal Value of Lambda; Minimizes the Prediction Error
# Lambda Min - Minimizes out of sample loss
# Lambda 1SE - Largest value of Lambda within 1 Standard Error of Lambda Min.
################################################################
log(cv.lasso$lambda.min)
log(cv.lasso$lambda.1se)
# Fit the model on training set using lambda.min
model.lasso.min <- glmnet(train_x, train_y, alpha = 1, lambda = cv.lasso$lambda.min)
# Display Regression Coefficients
coef(model.lasso.min)
# Fit the model on training set using lambda.min
model.lasso.min <- glmnet(train_x, train_y, alpha = 1, lambda = cv.lasso$lambda.1se)
# Display Regression Coefficients
coef(model.lasso.min)
# Display Regression Coefficients
coef(model.lasso.min)[1]
# Display Regression Coefficients
coef(model.lasso.min)[[1]]
# Display Regression Coefficients
coef(model.lasso.min)
# Display Regression Coefficients
rownames(coef(model.lasso.min))
# Display Regression Coefficients
coef(model.lasso.min)
lm3 <- lm(pd ~ unrate_perc + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc + Age_85_perc + VIOL, data = modelTrain)
summary(lm3)
vif(lm1)
lm3 <- lm(pd ~ log(unrate_perc) + imig_perc + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc + Age_85_perc + VIOL, data = modelTrain)
summary(lm3)
lm3 <- lm(pd ~ log(unrate_perc) + log(imig_perc) + dmig_perc + popFemale_perc + AmInd_perc + Asian_perc + AfAm_perc + Age_0_14_perc +
Age_45_54_perc + Age_55_64_perc + Age_65_74_perc + Age_74_84_perc + Age_85_perc + VIOL, data = modelTrain)
summary(lm3)
