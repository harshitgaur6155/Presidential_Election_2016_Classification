# Import/Load the data set
#location <- "~/Documents/Northeastern University/MPS Analytics/ALY 6015/"
location <- "C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/"
ElectionData <- read.csv(paste0(location, "Final Project/Presidential_Election_2016_Classification/Data/2016Election.csv"))
View(ElectionData)
# Declaring the names of packages to be imported
packageList <- c("tidyverse", "vtable", "RColorBrewer", "corrplot", "car", "psych", "stargazer")
for (package in packageList) {
if (!package %in% rownames(installed.packages()))
{ install.packages(package) }
# Import the package
library(package, character.only = TRUE)
}
# Import/Load the data set
#location <- "~/Documents/Northeastern University/MPS Analytics/ALY 6015/"
location <- "C:/Users/rajak/OneDrive/Desktop/Study/University/ALY6015 - Intermediate Analytics/"
ElectionData <- read.csv(paste0(location, "Final Project/Presidential_Election_2016_Classification/Data/2016Election.csv"))
# Get a Glimpse/View of the data set
glimpse(ElectionData)
# Descriptive Statistics of 'Total Votes' in 2008, 2012, 2016
totalVotes <- ElectionData %>%
select(v2008, v2012, v2016)
View(describe(totalVotes))
stargazer(totalVotes, type = "text", title = "Table 1: Total Votes", out = "total_votes_table.txt")
View(ElectionData)
View(totalVotes)
View(ElectionData)
View(ElectionData)
# line chart of outcome variable 'Total votes' by state and year
totalVotesL <- ElectionData %>%
select(state, v2008, v2012, v2016) %>% group_by(state) %>% summarise('2008' = sum(v2008))
View(totalVotesL)
# line chart of outcome variable 'Total votes' by state and year
totalVotesL <- ElectionData %>%
select(state, v2008, v2012, v2016) %>% group_by(state) %>% summarise('2008' = sum(v2008, na.rm = TRUE))
View(totalVotesL)
# line chart of outcome variable 'Total votes' by state and year
totalVotesL <- ElectionData %>%
select(state, v2008, v2012, v2016) %>% group_by(state) %>% summarise('2008' = sum(v2008, na.rm = TRUE),
'2012' = sum(v2012, na.rm = TRUE),
'2016' = sum(v2016, na.rm = TRUE))
View(totalVotesL)
gather(totalVotesL, key = 'state')
gather(totalVotesL, key = 'year')
?gather
gather(totalVotesL, year, tVotes, c('2008', '2012', '2016'))
# line chart of outcome variable 'Total votes' by state and year
totalVotesL <- ElectionData %>%
select(state, v2008, v2012, v2016) %>% group_by(state) %>% summarise('2008' = sum(v2008, na.rm = TRUE),
'2012' = sum(v2012, na.rm = TRUE),
'2016' = sum(v2016, na.rm = TRUE)) %>%
gather(year, tVotes, c('2008', '2012', '2016'))
View(totalVotesL)
ggplot(data = totalVotesL) %>%
geom_line(mapping = aes(x = state, y = tVotes))
ggplot(data = totalVotesL) %>%
geom_line(mapping = aes(x = state, y = tVotes, col = year))
ggplot(data = totalVotesL) %>%
geom_line(mapping = aes(x = state, y = tVotes, color = year))
ggplot(data = totalVotesL) %>%
geom_point(mapping = aes(x = state, y = tVotes, color = year))
ggplot(data = totalVotesL) %>%
geom_bar(mapping = aes(x = state, y = tVotes, color = year))
View(totalVotesL)
ggplot(data = as.data.frame(totalVotesL)) %>%
geom_line(mapping = aes(x = state, y = tVotes, color = year))
class(totalVotesL)
mode(totalVotesL)
typeof(totalVotesL)
df <- data.frame(totalVotesL)
ggplot(data = df) %>%
geom_line(mapping = aes(x = state, y = tVotes, color = year))
ggplot(data = totalVotesL) +
geom_line(mapping = aes(x = state, y = tVotes, color = year))
ggplot(data = totalVotesL) +
geom_bar(mapping = aes(x = state, y = tVotes, color = year))
geom_bar(mapping = aes(x = state, y = tVotes)
)
ggplot(data = totalVotesL) +
geom_bar(mapping = aes(x = state, y = tVotes))
ggplot(data = totalVotesL) +
geom_point(mapping = aes(x = state, y = tVotes, color = year))
ggplot(data = totalVotesL) +
geom_smooth(mapping = aes(x = state, y = tVotes, color = year))
ggplot(data = totalVotesL) +
geom_line(mapping = aes(x = state, y = tVotes, color = year))
ggplot(data = totalVotesL) +
geom_point(mapping = aes(x = state, y = tVotes, color = year)) +
geom_line(mapping = aes(x = state, y = tVotes, color = year))
ggplot(data = totalVotesL) +
geom_point(mapping = aes(x = state, y = tVotes, color = year)) +
geom_line(mapping = aes(x = state, y = tVotes, color = year, group = year))
ggplot(data = totalVotesL) +
geom_point(mapping = aes(x = state, y = tVotes, color = year)) +
geom_line(mapping = aes(x = state, y = tVotes, group = year))
ggplot(data = totalVotesL) +
geom_line(mapping = aes(x = state, y = tVotes, group = year))
ggplot(data = totalVotesL) +
geom_line(mapping = aes(x = state, y = tVotes, group = year, color = year))
ggplot(data = totalVotesL) +
geom_bar(mapping = aes(x = state, y = tVotes, group = year, color = year))
ggplot(data = totalVotesL) +
stat_count(mapping = aes(x = state, y = tVotes, group = year, color = year))
ggplot(data = totalVotesL) +
geom_bar(mapping = aes(x = state, y = tVotes, group = year, color = year, stat = "identity"))
ggplot(data = totalVotesL) +
geom_bar(mapping = aes(x = state, y = tVotes, stat = "identity"))
ggplot(data = totalVotesL, mapping = aes(x = state, y = tVotes)) +
geom_bar(position = "stack", stat = "identity")
ggplot(data = totalVotesL, mapping = aes(x = state, y = tVotes, fill = year)) +
geom_bar(position = "stack", stat = "identity")
ggplot(data = totalVotesL, mapping = aes(x = state, y = tVotes, fill = year)) +
geom_bar(position = "stack", stat = "identity") +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = state, y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw()
unique(totalVotesL$state)
length(unique(totalVotesL$state))
## set the levels in order we want
theTable <- within(totalVotesL,
state <- factor(state,
levels=names(sort(table(state),
decreasing=TRUE))))
View(theTable)
## set the levels in order we want
theTable <- within(totalVotesL,
state <- factor(c(state, year),
levels=names(sort(table(state),
decreasing=TRUE))))
## set the levels in order we want
theTable <- within(totalVotesL,
state <- factor(c(state, year),
levels=names(sort(table(c(state, year)),
decreasing=TRUE))))
?scale_x_discrete
ggplot(data = totalVotesL, mapping = aes(reorder(x = state, y = tVotes), fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = state, y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), state, function(x) sum(x)),
y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), state, function(x) length(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), totalVotesL$tVotes, function(x) sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), totalVotesL[which(year == '2008'), 'tVotes'], function(x) sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), totalVotesL[which(totalVotesL$year == '2008'), 'tVotes'], function(x) sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), totalVotesL[which(totalVotesL$year == '2008'), "tVotes"], function(x) sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
totalVotesL[which(totalVotesL$year == '2008'), "tVotes"]
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), totalVotesL[which(totalVotesL$year == '2008'), "tVotes"], function(x) sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), totalVotesL[which(totalVotesL$year == "2008"), "tVotes"], function(x) sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw() +
scale_x_discrete()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) function(x)-sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
theme(axis.text.x= element_text(family, face, colour, size)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme_bw()
theme(axis.text.x = element_text(face="bold", color="#993333", size=14, angle=45) +
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(face="bold", color="#993333", size=14, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(face="bold", color="#993333", size=4, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(face="bold", color="#993333", size=4, angle=45),
axis.text.y = element_text(face="bold", color="#993333",  size=14, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(face="bold", color="#993333", size=4, angle=45),
axis.text.y = element_text(face="bold", color="#993333",  size=14, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(face="bold", color="#993333", size=4, angle=90),
axis.text.y = element_text(face="bold", color="#993333",  size=14, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
# labs(title = "Total Votes by State & Year") +
# scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(face="bold", color="#993333", size=4, angle=90),
axis.text.y = element_text(face="bold", color="#993333",  size=14, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(face="bold", color="#993333", size=14, angle=90),
axis.text.y = element_text(face="bold", color="#993333",  size=14, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(size=14, angle=90),
axis.text.y = element_text(size=14, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(size=14, angle=90),
axis.text.y = element_text(size=14, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(size=28, angle=90),
axis.text.y = element_text(size=14, angle=45)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme(axis.text.x = element_text(size=228, angle=90),
axis.text.y = element_text(size=14, angle=45)) +
theme_bw()
options(scipen=999)
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
scale_y_continuous(labels = label_number(suffix = " M", scale = 1e-6)) +
theme_bw()
library(scales)
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
scale_y_continuous(labels = label_number(suffix = " M", scale = 1e-6)) +
theme_bw()
ggplot(data = totalVotesL, mapping = aes(x = reorder(factor(state), tVotes, function(x) -1*sum(x)), y = tVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Votes by State & Year") +
scale_x_discrete(name ="States") +
scale_y_continuous(name = "Total Votes", labels = label_number(suffix = " M", scale = 1e-6)) +
theme_bw()
View(ElectionData)
totalDVotesL <- ElectionData %>%
select(state, vd2008, vd2012, vd2016) %>% group_by(state) %>% summarise('2008' = sum(vd2008, na.rm = TRUE),
'2012' = sum(vd2012, na.rm = TRUE),
'2016' = sum(vd2016, na.rm = TRUE)) %>%
gather(year, tdVotes, c('2008', '2012', '2016'))
ggplot(data = totaldVotesL, mapping = aes(x = reorder(factor(state), tdVotes, function(x) -1*sum(x)), y = tdVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Democrat Votes by State & Year") +
scale_x_discrete(name ="States") +
scale_y_continuous(name = "Total Democrat Votes", labels = label_number(suffix = " M", scale = 1e-6)) +
theme_bw()
ggplot(data = totalDVotesL, mapping = aes(x = reorder(factor(state), tdVotes, function(x) -1*sum(x)), y = tdVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Democrat Votes by State & Year") +
scale_x_discrete(name ="States") +
scale_y_continuous(name = "Total Democrat Votes", labels = label_number(suffix = " M", scale = 1e-6)) +
theme_bw()
View(ElectionData)
ggplot(data = totalRVotesL, mapping = aes(x = reorder(factor(state), tgVotes, function(x) -1*sum(x)), y = tgVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Republican Votes by State & Year") +
scale_x_discrete(name ="States") +
scale_y_continuous(name = "Total Republican Votes", labels = label_number(suffix = " M", scale = 1e-6)) +
theme_bw()
totalRVotesL <- ElectionData %>%
select(state, vg2008, vg2012, vg2016) %>% group_by(state) %>% summarise('2008' = sum(vg2008, na.rm = TRUE),
'2012' = sum(vg2012, na.rm = TRUE),
'2016' = sum(vg2016, na.rm = TRUE)) %>%
gather(year, tgVotes, c('2008', '2012', '2016'))
ggplot(data = totalRVotesL, mapping = aes(x = reorder(factor(state), tgVotes, function(x) -1*sum(x)), y = tgVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Republican Votes by State & Year") +
scale_x_discrete(name ="States") +
scale_y_continuous(name = "Total Republican Votes", labels = label_number(suffix = " M", scale = 1e-6)) +
theme_bw()
ggplot(data = totalRVotesL, mapping = aes(x = reorder(factor(state), tgVotes, function(x) -1*sum(x)), y = tgVotes, fill = year)) +
geom_area(position = "dodge", stat = "identity") +
labs(title = "Total Republican Votes by State & Year") +
scale_x_discrete(name ="States") +
scale_y_continuous(name = "Total Republican Votes", labels = label_number(suffix = " M", scale = 1e-6)) +
theme_bw()
ggplot(data = totalRVotesL, mapping = aes(x = reorder(factor(state), tgVotes, function(x) -1*sum(x)), y = tgVotes, fill = year)) +
geom_bar(position = "dodge", stat = "identity") +
labs(title = "Total Republican Votes by State & Year") +
scale_x_discrete(name ="States") +
scale_y_continuous(name = "Total Republican Votes", labels = label_number(suffix = " M", scale = 1e-6)) +
theme_bw()
